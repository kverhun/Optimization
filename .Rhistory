crit1 <- FALSE
crit2 <- FALSE
eps <- epsder <- 0.1
fv
x <- dt$x
fv <- dt$fv
gradv <- dt$gradv
A <- dt$A
tempfunc <- function(lambda)
{
return(f(x - lambda %*% A %*% gradv))
}
lambdaopt <- DSKP(tempfunc,0,eps,eps)
lambdaopt
xNext <- x - lambdaopt %*% A %*% gradv
fvNext <- f(xNext)
gradvNext <- grad(f,xNext,epsder)
ANext <- A
+ (x %*% t(x))/(t(x) %*% gradv)
- (A %*% gradv %*% t(gradv) %*% A)/(t(gradv) %*% A %*% gradv)
gradv
xNext
x
f <- function(X)
return (X[1]^2 + X[2]^2)
x0 <- c(10,10)
DFP(f,x0,0.1,0.1,0.1,0.1)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(f,x0,0.1,0.1,0.1,0.1)
f
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(f,x0,0.1,0.1,0.1,0.1)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(f,x0,0.1,0.1,0.1,0.1)
tempfunc <- function(lambda)
{
return((function(lambda))(f(x - lambda * (A %*% gradv))))
}
tempfunc <- function(lambda)
{
return((function(lambda))(f(x - lambda * (A %*% gradv))))
}
source('~/.active-rstudio-document')
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(f,x0,0.1,0.1,0.1,0.1)
f
f(c(10,10))
A
dim <- length(x0)
x <- x0
fv <- f(x0)
gradv <- grad(f,x,eps4)
A <- eye(dim)
dt <- list (x=x,fv=fv,gradv=gradv,A=A,rallowed = TRUE)
dim
x
fv
gradv
der (f,c(10,10), 1)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/derivatives.r')
DFP(f,x0,0.1,0.1,0.1,0.1)
grad(f,c(10,10))
1:2
x
dim <- length(x)
gradv <- 1:dim
dim
gradv
i <- 1
gradv[i] <- der(f,x,i,eps,type)
gradv[i] <- der(f,x,i,eps,type="c")
gradv
i <- 2
gradv[i] <- der(f,x,i,eps,type="c")
gradv
gradv <- 0
gradv
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/derivatives.r')
grad(f,c(10,10))
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/derivatives.r')
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/derivatives.r')
grad(f,c(10,10))
der (f,c(10,10),2)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/derivatives.r')
der (f,c(10,10),2)
grad (f,c(10,10)
)
DFP(f,c(10,10),eps)
DFP(f,c(10,10),eps,eps,eps,eps)
DFP(f,c(10,10),eps,eps,eps)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(f,c(10,10),eps,eps,eps)
f
gradv <- grad(f,c(10,10))
gradv
x0
dim <- length(x0)
x <- x0
fv <- f(x0)
gradv <- grad(f,x,eps4)
A <- eye(dim)
dim
x
fv
gradv
A
dt <- list (x=x,fv=fv,gradv=gradv,A=A,rallowed = TRUE)
crit1 <- FALSE
crit2 <- FALSE
dtNext <- DFPStep(f,dt,eps3,eps4)
eps
epsder
x <- dt$x
fv <- dt$fv
gradv <- dt$gradv
A <- dt$A
x
fv
gradv
A
tempfunc <- function(lambda)
{
return ( f(x - lambda * (A %*% gradv)) )
}
tempfunc(10)
tempfunc(0)
tempfunc(-1)
tempfunc(1)
tempfunc(0.5)
tempfunc(0.6)
curve(tempfunc)
gradv
A
A %*% gradv
10 * A
10 * (A %*% gradv)
x
x - lambda * (A %*% gradv))
x - lambda * (A %*% gradv)
lambda <- 2
x - lambda * (A %*% gradv)
lambda * (A %*% gradv)
dskp(tempfunc,10)
DSKP(tempfunc,10)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dskp.r')
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
dt
DFPStep(f,dt,0.1,0.1)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFPStep(f,dt,0.1,0.1)
x <- dt$x
fv <- dt$fv
gradv <- dt$gradv
A <- dt$A
tempfunc <- function (lambda)
return (f(x - lambda * (A %*% gradv)))
lambdaopt <- DSKP(tempfunc,0,eps1=eps,eps2 = eps)
lambdaopt <- golden(tempfunc,svenn(tempfunc,0,eps/2),eps)
lambdaopt
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DPF(f,x0)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(f,x0)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(f,x0)
x <- dt$x
fv <- dt$fv
gradv <- dt$gradv
A <- dt$A
#end data unpacking
#lambda
tempvector <- A %*% gradv
x
fv
gradv
A
tempvector
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
x <- dt$x
fv <- dt$fv
gradv <- dt$gradv
A <- dt$A
#end data unpacking
#lambda
tempvector <- t(A %*% gradv)
tempvector
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
tempvector <- t(A %*% gradv)[1,]
tempvector
x
DFP(f,x0)
tempfunc
f
tempfunc <- function (lambda)
return (func(x - lambda * tempvector))
DFP(f,x0)
lambda <- 0.4
lambda <- 0.5
tempvector
lambda*tempvector
x0 - lambda*tempvector
f(x0-lambda*tempvector)
f
lambdaopt <- golden(tempfunc,svenn(tempfunc,0,eps/2),eps)
func <- f
lambdaopt <- golden(tempfunc,svenn(tempfunc,0,eps/2),eps)
lambdaopt
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(f,x0)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(f,x0)
x
x %*% t(x)
t(x) %*% gradv
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(f,x0)
chf <- function(x)
return (cosh(x[1]^2 + x[2]^2))
DFP(chf,c(10,9))
f <- chf
x0 <- c(10,9)
dim <- length(x0)
x <- x0
fv <- f(x0)
gradv <- grad(f,x,eps4)
A <- eye(dim)
dt <- list (x=x,fv=fv,gradv=gradv,A=A,rallowed = TRUE)
crit1 <- FALSE
crit2 <- FALSE
x0
dim
dtNext <- DFPStep(f,dt,eps3,eps4)
dt
dtNext
func <-f
x <- dt$x
fv <- dt$fv
gradv <- dt$gradv
A <- dt$A
tempvector <- t(A %*% gradv)[1,]
tempfunc <- function (lambda)
return (func(x - lambda * tempvector))
curve(tempfunc)
xs <- seq (-10,10,by = 0.1)
ys <- xs
for (i in 1:200)
ys[i]<-f(xs[i])
plot(xs,ys)
xs
ys
for (i in 1:200)
ys[i]<-tempfunc(xs[i])
plot(xs,ys)
ys
source('E:/education/univ/6 sem/Optimization/Coursepaper/scripts/contlines.r')
cont(f,-10,10,0.1)
f
cont(f,c(-10,10),c(-10,10),0.1)
cont(f,c(-10,10),c(-10,10),0.1, nlevels = 100)
cont(f,c(-1,1),c(-1,1),0.1, nlevels = 100)
cont(f,c(-1,1),c(-1,1),0.1, nlevels = 10)
DFP(chf,c(1,1))
DFP(chf,c(2,2))
DFP(chf,c(1.5,1.5))
DFP(chf,c(1.6,1.6))
DFP(chf,c(1.7,1.7))
DFP(chf,c(1.9,1.9))
DFP(chf,c(1.8,1.9))
DFP(chf,c(1.8,1.8))
inf
INF
+INF
+Inf
Inf-1
Inf/Inf
Inf-100500
10000000
100000000000000000000000000000000000000000000000000
100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1e+300
1e+300000
1e+30000
1e+3000
1e+300
1e+1000
1e+500
1e+300
1e+400
1e+350
1e+3250
1e+325
1e+312
1e+310
1e+301
1e+302
1e+305
1e+310
1e+309
1e+308
f
f <- function(x)
{
val <- cosh(x[1]^2 + x[2]^2)
if (val == Inf) val <- 1e+308
return (val)
)
f <- function(x)
+ {
+ val <- cosh(x[1]^2 + x[2]^2)
+ if (val == Inf) val <- 1e+308
+ return (val)
+ }
f <- function(x)
{
val <- cosh(x[1]^2 + x[2]^2)
if (val == Inf) val <- 1e+308
return (val)
}
f
DFP(f,c(10,10))
chf
chf(c(10,10))
func
tempfunc <- function (lambda)
return (func(x - lambda * tempvector))
tempfunc(0)
tempfunc(1)
tempfunc(-1)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(f,c(1,1))
tempfunc
DSKP(tempfunc,0,0.1,0.1)
Inf > Inf
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dskp.r')
DSKP(tempfunc,0,0.1,0.1)
f
int <- svenn(f, x0, deltaeval(f,x0,eps1,eps2))
int
f <- tempfunc
int <- svenn(f, x0, deltaeval(f,x0,eps1,eps2))
int
tempfunc
x0 <- 0
int <- svenn(f, x0, deltaeval(f,x0,eps1,eps2))
int
x1 <- int[1]
x3 <- int[2]
x2 <- (x1 + x3)/2
f1 <- f(x1)
f2 <- f(x2)
f3 <- f(x3)
xastr <- x2 + ((x2-x1)*(f1-f3))/(2*(f1-2*f2+f3))
# 2) pauell
return (Pauell (f,xastr, eps1, eps2))
x <- c(x0,x0+dx,NaN)
fv <- c(f(x[1]), f(x[2]), NaN)
fv
fsq <- function(x)
return 1
roz
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/testfunctions.r')
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(roz,c(-1.2,0))
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(roz,c(-1.2,0))
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(roz,c(-1.2,0))
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(roz,c(-1.2,0))
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(roz,c(-1.2,0))
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(roz,c(-1.2,0))
dim <- length(x0)
x <- x0
fv <- f(x0)
gradv <- grad(f,x,eps4)
A <- eye(dim)
dt <- list (x=x,fv=fv,gradv=gradv,A=A,rallowed = TRUE)
crit1 <- FALSE
crit2 <- FALSE
gradv
roz
grad(roz,c(-1.2,0))
grad(roz,c(-1.2,0),0.01)
grad(roz,c(-1.2,0),0.00001)
grad(roz,c(-1.2,0),0.1)
grad(roz,c(-1.2,0),0.01)
A
x0
x0 <- c(-1.2,0)
dim <- length(x0)
x <- x0
fv <- f(x0)
gradv <- grad(f,x,eps4)
A <- eye(dim)
dt <- list (x=x,fv=fv,gradv=gradv,A=A,rallowed = TRUE)
A
A %*% gradv
gradv
x
gradv <- grad(f,x,eps4)
gradv
grad(roz,c(-1.2,0))
f <- roz
dim <- length(x0)
x <- x0
fv <- f(x0)
gradv <- grad(f,x,eps4)
A <- eye(dim)
dt <- list (x=x,fv=fv,gradv=gradv,A=A,rallowed = TRUE)
crit1 <- FALSE
crit2 <- FALSE
A %*% gradv
dt
dtNext <- DFPStep(f,dt,eps3,eps4)
dtNext
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(roz,c(-1.2,0),0.01)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(roz,c(-1.2,0),0.01)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(roz,c(-1.2,0),0.01)
f
x0
eps1 <- 0.01
eps2
eps2 <- eps3 <- eps4 <- 0.01
dim <- length(x0)
x <- x0
fv <- f(x0)
gradv <- grad(f,x,eps4)
A <- eye(dim)
dt <- list (x=x,fv=fv,gradv=gradv,A=A,rallowed = TRUE)
crit1 <- FALSE
crit2 <- FALSE
i <- 0
i <- i + 1
cat(i,"\t", dt$x,"\n")
dtNext <- DFPStep(f,dt,eps3,eps4)
dtNext
if (dtNext$fv > eps1)
{
if (abs((dtNext$fv - dt$fv)/dt$fv) < eps1)
crit1 <- TRUE
else
crit2 <- FALSE
}
else
{
if (norm(dtNext$gradv - dt$gradv) < eps1)
crit1 <- TRUE
else
crit1 <- FALSE
}
crit1
if (norm(dt$x) > eps2)
{
if (norm(dtNext$x - dt$x)/norm(dt$x) < eps2)
crit2 <- TRUE
else
crit2 <- FALSE
}
else
{
if (norm (dtNext$x - dt$x) < eps2)
crit2 <- TRUE
else
crit2 <- FALSE
}
crit2
dt <- dtNext
dt$rallowed <- TRUE
dt
i <- i + 1
cat(i,"\t", dt$x,"\n")
dtNext <- DFPStep(f,dt,eps3,eps4)
dtNext
dt <- dtNext
dt$rallowed = FALSE
dt$A <- eye(dim)
dtNext <- DFPStep(f,dt,eps3,eps4)
dt
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(roz,c(-1.2,0))
DFP(roz,c(-1.2,0), 0.00000001)
DFP(roz,c(-1.2,0), 0.001,0.0001,0.00000001,0.00000001)
roz(c(0.99,0.99))
roz(c(0.991,0.991))
DFP(roz, c(-1.2,0), 0.01,0.1,0.001,0.001)
DFP(roz, c(-1.2,0), 0.001,0.1,0.001,0.001)
DFP(roz, c(-1.2,0), 0.001,0.1,0.01,0.01)
DFP(roz, c(-1.2,0), 0.001,0.1,0.001,0.001)
DFP(roz, c(-1.2,0), 0.0001,0.1,0.001,0.001)
DFP(roz, c(-1.2,0), 0.001,0.01,0.001,0.001)
DFP(roz, c(-1.2,0), 0.01,0.01,0.001,0.001)
DFP(roz, c(-1.2,0), 0.001,0.01,0.001,0.001)
DFP(roz, c(-1.2,0), 0.001,0.1,0.001,0.001)
DFP(roz, c(-1.2,0), 0.005,0.1,0.001,0.001)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/dfp.r')
DFP(roz, c(-1.2,0), 0.005,0.1,0.001,0.001)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/testfunctions.r')
DFP(POW, c(-1.2,0), 0.005,0.1,0.001,0.001)
DFP(pow, c(-1.2,0), 0.005,0.1,0.001,0.001)
source('E:/education/univ/6 sem/Optimization/Coursepaper/r/Optimization/testfunctions.r')
DFP(pow, c(-1.2,0), 0.005,0.1,0.001,0.001)
DFP(pow, c(-1.2,0), 0.005,0.1,0.001,0.001)
DFP(fsqr, c(-1.2,0), 0.005,0.1,0.001,0.001)
DFP(fsqr, c(-1.2,0), 0.05,0.1,0.001,0.001)
DFP(fsqr, c(-1.2,0), 0.01,0.1,0.001,0.001)
